<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lais</title>
    <link rel="stylesheet" href="/templates/static/styles2.css?v=16">
    <script src="/templates/static/cache-manager.js?v=16"></script>
    <script>
        // API Configuration - –µ–¥–∏–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç /api/v1/<service>
        // Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç —ç—Ç–∏ –ø—É—Ç–∏ –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º
        const API_V1 = "/api/v1";
        const AUTH_API = `${API_V1}/auth`;
        const POSTS_API = `${API_V1}/posts`;
        const CHAT_API = `${API_V1}/chat`;
        const IMEI_API = `${API_V1}/imei`;
        console.log('üîß API BASE:', API_V1);
    </script>
</head>
<body>

    <header class="header-fixed">
        <div class="nav-container">
            <a href="/" class="logo">lais</a>
            <div style="flex:1"></div>
            <div class="header-controls">
                <a href="/imei-check" class="btn btn-text" style="margin-right: 10px;">–ü—Ä–æ–≤–µ—Ä–∫–∞ IMEI</a>
                <button class="btn btn-text" id="loginBtn">–í–æ–π—Ç–∏</button>
                <a href="/post-ad" id="postAdBtn" class="btn btn-primary">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å</a>
            </div>
        </div>
    </header>

    <section class="hero-section">
        <h1 class="hero-title">–ö—É–ø–∏. –ü—Ä–æ–¥–∞–π. –û–±–Ω–æ–≤–∏—Å—å.</h1>
        <p class="hero-text">–õ—É—á—à–µ–µ –º–µ—Å—Ç–æ –¥–ª—è —Ç–µ—Ö–Ω–∏–∫–∏ Apple –∏ –Ω–µ —Ç–æ–ª—å–∫–æ.</p>
    </section>

    <!-- <div class="category-scroll">
        <div class="cat-pill active">–í—Å–µ</div>
        <div class="cat-pill">iPhone</div>
        <div class="cat-pill">MacBook</div>
        <div class="cat-pill">iPad</div>
        <div class="cat-pill">AirPods</div>
        <div class="cat-pill">Watch</div>
        <div class="cat-pill">–ö–æ–Ω—Å–æ–ª–∏</div>
    </div> -->

    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <div class="filters-section">
        <div class="filters-header">
            <div class="filters-title">
                <!-- Apple-style funnel icon -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -3px; color: var(--color-text-light); margin-right: 8px;"><path d="M3 6h18"/><path d="M6 12h12"/><path d="M10 18h4"/></svg>
                –§–∏–ª—å—Ç—Ä—ã
            </div>
            <button id="toggleFiltersBtn" class="filters-toggle" aria-expanded="true">
                <!-- chevron down/up icon -->
                <svg class="chevron chevron-up" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M6 15l6-6 6 6"/></svg>
                <svg class="chevron chevron-down" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" style="display:none;"><path d="M6 9l6 6 6-6"/></svg>
                –°–∫—Ä—ã—Ç—å
            </button>
        </div>
        <div id="filtersBody" class="filters-body">
        <div class="filters-grid">
            <div class="filter-group">
                <label>
                    <!-- iPhone icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px; margin-right:6px;"><rect x="7" y="2" width="10" height="20" rx="2"/><circle cx="12" cy="18" r="1"/></svg>
                    –ú–æ–¥–µ–ª—å
                </label>
                <select id="filterModel">
                    <option value="">–í—Å–µ</option>
                    <option value="17">iPhone 17</option>
                    <option value="17pro">iPhone 17 Pro</option>
                    <option value="16">iPhone 16</option>
                    <option value="16pro">iPhone 16 Pro</option>
                    <option value="15">iPhone 15</option>
                    <option value="14pro">iPhone 14 Pro</option>
                </select>
            </div>

            <div class="filter-group">
                <label>
                    <!-- battery icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px; margin-right:6px;"><rect x="2" y="7" width="18" height="10" rx="2"/><rect x="4" y="9" width="10" height="6" rx="1"/><path d="M22 10v4"/></svg>
                    –ê–ö–ë (–æ—Ç)
                </label>
                <input type="number" id="filterBateryMin" placeholder="0%" min="0" max="100">
            </div>

            <div class="filter-group">
                <label>
                    <!-- battery icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px; margin-right:6px;"><rect x="2" y="7" width="18" height="10" rx="2"/><rect x="4" y="9" width="16" height="6" rx="1"/><path d="M22 10v4"/></svg>
                    –ê–ö–ë (–¥–æ)
                </label>
                <input type="number" id="filterBateryMax" placeholder="100%" min="0" max="100">
            </div>

            <div class="filter-group">
                <label>
                    <!-- checkmark icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px; margin-right:6px;"><path d="M20 6L9 17l-5-5"/></svg>
                    –°–æ—Å—Ç–æ—è–Ω–∏–µ
                </label>
                <select id="filterCondition">
                    <option value="">–í—Å–µ</option>
                    <option value="–ù–æ–≤—ã–π">–ù–æ–≤—ã–π</option>
                    <option value="–ö–∞–∫ –Ω–æ–≤—ã–π">–ö–∞–∫ –Ω–æ–≤—ã–π</option>
                    <option value="–ù–µ–±–æ–ª—å—à–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã">–ù–µ–±–æ–ª—å—à–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã</option>
                    <option value="–° –¥–µ—Ñ–µ–∫—Ç–æ–º">–° –¥–µ—Ñ–µ–∫—Ç–æ–º</option>
                    <option value="–ù–∞ –∑–∞–ø—á–∞—Å—Ç–∏">–ù–∞ –∑–∞–ø—á–∞—Å—Ç–∏</option>
                </select>
            </div>

            <div class="filter-group">
                <label>
                    <!-- circle icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px; margin-right:6px;"><circle cx="12" cy="12" r="6"/></svg>
                    –¶–≤–µ—Ç
                </label>
                <select id="filterColor">
                    <option value="">–í—Å–µ</option>
                    <option value="Black">–ß—ë—Ä–Ω—ã–π</option>
                    <option value="White">–ë–µ–ª—ã–π</option>
                    <option value="Red">–ö—Ä–∞—Å–Ω—ã–π</option>
                    <option value="Blue">–°–∏–Ω–∏–π</option>
                    <option value="Green">–ó–µ–ª—ë–Ω—ã–π</option>
                    <option value="Gold">–ó–æ–ª–æ—Ç–æ–π</option>
                    <option value="Silver">–°–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π</option>
                </select>
            </div>

            <div class="filter-group">
                <label>
                    <!-- memory chip icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px; margin-right:6px;"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M9 4v4M15 4v4M9 16v4M15 16v4"/></svg>
                    –ü–∞–º—è—Ç—å (–æ—Ç)
                </label>
                <select id="filterMemory">
                    <option value="">–í—Å–µ</option>
                    <option value="64">–û—Ç 64GB</option>
                    <option value="128">–û—Ç 128GB</option>
                    <option value="256">–û—Ç 256GB</option>
                    <option value="512">–û—Ç 512GB</option>
                    <option value="1024">–û—Ç 1TB</option>
                </select>
            </div>

            <div class="filter-group">
                <label>–¶–µ–Ω–∞ (‚Ç¨)</label>
                <input type="number" id="filterPriceMin" placeholder="–û—Ç" min="0">
            </div>

            <div class="filter-group">
                <label>–¶–µ–Ω–∞ (‚Ç¨)</label>
                <input type="number" id="filterPriceMax" placeholder="–î–æ" min="0">
            </div>
        </div>

        
        <div class="filters-actions">
            <button id="applyFiltersBtn">üîç –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
            <button id="clearFiltersBtn">‚úï –û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        </div>
        
    </div>

    <main class="main-container">
        <div class="product-grid" id="productGrid">
            <!-- –ü–æ—Å—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </main>

    <div class="modal" id="authModal">
        <div class="modal-box">
            <div style="text-align: right;">
                <button id="closeModal" style="background:none; border:none; cursor:pointer; font-size:24px; color: var(--color-text-light);">&times;</button>
            </div>
            
            <div class="auth-header">
                <h2>–í—Ö–æ–¥ –≤ Lais</h2>
                <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ –∏ –ø–æ–∫—É–ø–∫–∞–º–∏</p>
            </div>

            <div style="display: flex; gap: 16px; margin-bottom: 24px; border-bottom: 1px solid var(--color-border);">
                <button class="btn-tab" onclick="switchTab('login')" style="border: none; border-bottom: 2px solid var(--color-primary); color: var(--color-text); padding: 12px 0; flex: 1; background: none; cursor: pointer; font-weight: 600;">–í—Ö–æ–¥</button>
                <button class="btn-tab" onclick="switchTab('register')" style="border: none; border-bottom: 2px solid transparent; color: var(--color-text-light); padding: 12px 0; flex: 1; background: none; cursor: pointer; font-weight: 600;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <div id="loginForm">

                <div class="oauth-buttons">
                    <a href="#" onclick="window.location.href = `${AUTH_API}/google/login`; return false;" class="oauth-btn google">
                        <svg viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Google
                    </a>
                    <button class="oauth-btn facebook">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Facebook
                    </button>
                    <button class="oauth-btn apple">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.127 3.675-.552 9.12 1.519 12.123.987 1.431 2.178 3.065 3.749 3.007 1.497-.056 2.06-.967 3.866-.967 1.785 0 2.316.967 3.863.967 1.626 0 2.786-1.488 3.807-2.958 1.165-1.683 1.651-3.315 1.681-3.399-.037-.018-3.265-1.248-3.3-4.946-.034-3.093 2.536-4.569 2.664-4.656-1.453-2.124-3.707-2.363-4.515-2.389-1.02-.032-2.344.599-3.081.599-.739 0-1.947-.556-2.333-.355zM12.752 4.55c.846-1.021 1.418-2.438 1.262-3.853-1.222.049-2.7 .813-3.578 1.839-.787.914-1.471 2.378-1.286 3.78 1.363.105 2.753-.745 3.602-1.766z"/></svg>
                        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Apple
                    </a>
                </div>

                <div class="divider"><span>–∏–ª–∏ –ø–æ email</span></div>

                <form id="emailAuthForm">
                    <div class="form-group">
                        <input type="text" class="form-input" placeholder="Email or username" required>
                        <span style="color: red;" class="error-message"></span>
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-input" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <span style="color: red;" class="error-message"></span>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; justify-content: center;">–í–æ–π—Ç–∏</button>
                </form>

            </div>

            <div id="registerForm" style="display: none;">
                <form id="emailRegisterForm" onsubmit="event.preventDefault()">
                    <div class="form-group">
                        <input type="email" class="form-input" placeholder="Email" required>
                        <span style="color: red;" class="error-message"></span>
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-input" placeholder="–ù–∏–∫" required>
                        <span style="color: red;" class="error-message"></span>
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-input" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <span style="color: red;" class="error-message"></span>
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-input" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å" required>
                        <span style="color: red;" class="error-message"></span>
                    </div>
                    <div class="form-group" style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="termsCheck" required style="width: 18px; height: 18px; cursor: pointer;">
                        <label for="termsCheck" style="font-size: 13px; color: var(--color-text-light); cursor: pointer;">–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø–ª–æ—â–∞–¥–∫–∏</label>
                    </div>
                    <span class="error-message" style="display: block; margin-bottom: 12px;"></span>
                    <button type="submit" class="btn btn-primary" style="width: 100%; justify-content: center;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                </form>
            </div>

        </div>

    </div>

    <style>
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç—å) */
    .filters-section {
        background: #fff;
        padding: 12px 16px;
        margin: 16px auto;
        border-radius: 14px;
        border: 1px solid var(--color-border);
        max-width: 1200px;
    }

    .filters-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 8px;
    }

    .filters-title {
        font-weight: 600;
        font-size: 15px;
        color: var(--color-text);
        display: flex;
        align-items: center;
    }

    .filters-toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid var(--color-border);
        background: #f5f5f7;
        color: var(--color-text);
        font-size: 13px;
        cursor: pointer;
    }

    .filters-body.collapsed {
        display: none;
    }

    .filters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 10px;
    }

    .filter-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .filter-group label {
        font-size: 13px;
        font-weight: 500;
        color: var(--color-text-light);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .filter-group input,
    .filter-group select {
        padding: 6px 10px;
        border: 1px solid var(--color-border);
        border-radius: 10px;
        font-size: 13px;
        background: #f5f5f7;
        color: var(--color-text);
        transition: all 0.2s;
    }

    .filter-group input:focus,
    .filter-group select:focus {
        outline: none;
        border-color: var(--color-primary);
        background: #fff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
    }

    .filters-actions {
        display: flex;
        gap: 8px;
        margin-top: 8px;
        flex-wrap: wrap;
    }

    .filters-actions button {
        padding: 8px 16px;
        border-radius: 8px;
        border: 1px solid var(--color-border);
        background: #f5f5f7;
        color: var(--color-text);
        cursor: pointer;
        font-weight: 500;
        font-size: 13px;
        transition: all 0.2s;
    }

    .filters-actions button:hover {
        background: var(--color-primary);
        color: #fff;
        border-color: var(--color-primary);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è Cookie –ú–æ–¥–∞–ª–∫–∏ */
    #cookieConsentModal {
        display: none;
        position: fixed;
        bottom: 24px;
        right: 24px;
        width: 340px;
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        border: 1px solid var(--color-border, #e5e5e5);
        padding: 24px;
        z-index: 9999;
        animation: slideIn 0.3s ease-out;
    }

    #cookieConsentModal.active {
        display: block;
    }

    @keyframes slideIn {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ú–µ–Ω—é –ü—Ä–æ—Ñ–∏–ª—è –≤ –•–µ–¥–µ—Ä–µ */
    .user-profile-wrapper {
        position: relative;
        margin-left: 12px;
        display: inline-block;
    }

    .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #f5f5f7;
        background-image: url('https://ui-avatars.com/api/?name=User&background=0D8ABC&color=fff'); /* –î–µ—Ñ–æ–ª—Ç–Ω–∞—è –∞–≤–∞—Ç–∞—Ä–∫–∞ */
        background-size: cover;
        background-position: center;
        cursor: pointer;
        border: 1px solid var(--color-border, #e5e5e5);
        transition: transform 0.2s;
    }

    .user-avatar:hover {
        transform: scale(1.05);
    }

    /* –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é */
    .profile-dropdown {
        display: none;
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: 12px;
        width: 200px;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        border: 1px solid var(--color-border, #e5e5e5);
        overflow: hidden;
        flex-direction: column;
    }

    .user-profile-wrapper:hover .profile-dropdown {
        display: flex;
    }

    .profile-dropdown a, 
    .profile-dropdown button {
        display: block;
        padding: 12px 16px;
        text-decoration: none;
        color: var(--color-text, #1d1d1f);
        font-size: 14px;
        text-align: left;
        background: none;
        border: none;
        cursor: pointer;
        transition: background 0.2s;
        width: 100%;
        font-family: inherit;
    }

    .profile-dropdown a:hover, 
    .profile-dropdown button:hover {
        background-color: #f5f5f7;
    }

    .profile-dropdown .divider {
        height: 1px;
        background-color: var(--color-border, #e5e5e5);
        margin: 0;
    }
    
    .logout-btn {
        color: #ff3b30 !important;
    }
</style>

<div id="cookieConsentModal">
    <h3 style="font-size: 18px; font-weight: 600; margin: 0 0 8px 0;">–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Cookies üç™</h3>
    <p style="font-size: 13px; color: #86868b; margin: 0 0 16px 0; line-height: 1.4;">
        –ü—Ä–æ–¥–æ–ª–∂–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∞–π—Ç–æ–º, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ cookie –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞.
    </p>
    <button id="acceptCookiesBtn" class="btn btn-primary" style="width: 100%; justify-content: center;">
        –•–æ—Ä–æ—à–æ
    </button>
</div>

<script>
(function() {
    // ==========================================
    // 1. –õ–û–ì–ò–ö–ê COOKIE MODAL (–û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ)
    // ==========================================
    const cookieModal = document.getElementById('cookieConsentModal');
    const acceptBtn = document.getElementById('acceptCookiesBtn');
    
    if (!localStorage.getItem('lais_cookie_consent')) {
        setTimeout(() => {
            cookieModal.classList.add('active');
        }, 1000);
    }

    acceptBtn.addEventListener('click', () => {
        localStorage.setItem('lais_cookie_consent', 'true');
        cookieModal.classList.remove('active');
    });

    // ==========================================
    // 2. –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò (–ß–µ—Ä–µ–∑ /auth/me)
    // ==========================================
    
    async function checkAuthAndBuildUI() {
        try {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (TTL: 5 –º–∏–Ω—É—Ç)
            const response = await cachedFetch(`${AUTH_API}/me`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                },
                credentials: 'include' 
            }, 5 * 60 * 1000);

            // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å 200 - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω
            if (response.ok) {
                const userData = await response.json();
                updateUIForLoggedInUser(userData);
                return;
            }
            
            // –ï—Å–ª–∏ 401 - –ø—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–∏—Ç—å access_token –∏—Å–ø–æ–ª—å–∑—É—è refresh_token
            if (response.status === 401) {
                const refreshResponse = await fetch(`${AUTH_API}/refresh`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include' 
                });

                // –ï—Å–ª–∏ refresh –≤–µ—Ä–Ω—É–ª 200 - –ø—Ä–æ–±—É–µ–º /auth/me –µ—â—ë —Ä–∞–∑
                if (refreshResponse.ok) {
                    const retryResponse = await fetch(`${AUTH_API}/me`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        credentials: 'include' 
                    });

                    if (retryResponse.ok) {
                        const userData = await retryResponse.json();
                        updateUIForLoggedInUser(userData);
                        return;
                    }
                }

                // –ï—Å–ª–∏ refresh –≤–µ—Ä–Ω—É–ª 401 - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–æ—á–Ω–æ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                console.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (refresh_token –∏—Å—Ç—ë–∫)");
                return;
            }
        } catch (error) {
            console.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∏–ª–∏ –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏");
        }
    }

    function updateUIForLoggedInUser(user) {
        // –ê. –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–í–æ–π—Ç–∏"
        const loginBtn = document.getElementById('loginBtn');
        if (loginBtn) loginBtn.style.display = 'none';

        // –ë. –î–æ–±–∞–≤–ª—è–µ–º –ê–≤–∞—Ç–∞—Ä–∫—É
        const headerControls = document.querySelector('.header-controls');
        if (headerControls) {
            // –§–æ—Ä–º–∏—Ä—É–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É —Å –∏–Ω–∏—Ü–∏–∞–ª–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const avatarUrl = user.avatar_url || `https://ui-avatars.com/api/?name=${user.username}&background=0D8ABC&color=fff`;

            const profileWrapper = document.createElement('div');
            profileWrapper.className = 'user-profile-wrapper';
            
            profileWrapper.innerHTML = `
                <div class="user-avatar" style="background-image: url('${avatarUrl}')" onclick="window.location.href='/profile'"></div>
                <div class="profile-dropdown">
                    <div style="padding: 12px 16px; border-bottom: 1px solid #eee; font-weight: 600; color: #888; font-size: 12px;">
                        ${user.username}
                    </div>
                    <a href="/profile">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
                    <a href="/profile/edit">‚öôÔ∏è –°–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</a>
                    <div class="divider"></div>
                    <button class="logout-btn" id="logoutAction">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
                </div>
            `;
            
            headerControls.appendChild(profileWrapper);
            
            // –í. –õ–æ–≥–∏–∫–∞ –í—ã—Ö–æ–¥–∞ (Logout)
            document.getElementById('logoutAction').addEventListener('click', async (e) => {
                e.stopPropagation(); 
                try {
                    await fetch(`${AUTH_API}/logout`, {
                        method: 'POST',
                        credentials: 'include' // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –ø–æ–Ω—è–ª, —á—å—é –∫—É–∫—É —É–¥–∞–ª—è—Ç—å
                    });
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞
                    window.location.reload();
                } catch (err) {
                    console.error('Logout failed', err);
                    window.location.reload();
                }
            });
        }
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫—Ä–∏–ø—Ç–∞
    checkAuthAndBuildUI();

})();
</script>

<script>
    /**
     * Helper —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è access_token –µ—Å–ª–∏ –æ–Ω –∏—Å—Ç—ë–∫.
     * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º–∏ API –∑–∞–ø—Ä–æ—Å–∞–º–∏.
     * 
     * –õ–æ–≥–∏–∫–∞:
     * 1. –ü—Ä–æ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å originalFetch
     * 2. –ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç 401 - –≤—ã–∑—ã–≤–∞–µ—Ç /auth/refresh –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è access_token
     * 3. –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä—è–µ—Ç originalFetch
     */
    async function fetchWithTokenRefresh(url, options = {}) {
        // –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å
        let response = await fetch(url, { ...options, credentials: 'include' });

        // –ï—Å–ª–∏ 401 - –ø—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω
        if (response.status === 401) {
            const refreshResponse = await fetch(`${AUTH_API}/refresh`, {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include'
            });

            // –ï—Å–ª–∏ refresh —É–¥–∞–ª—Å—è - –ø–æ–≤—Ç–æ—Ä—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å
            if (refreshResponse.ok) {
                response = await fetch(url, { ...options, credentials: 'include' });
            }
        }

        return response;
    }
</script>

    <script>
        const modal = document.getElementById('authModal');
        const loginBtn = document.getElementById('loginBtn');
        const closeBtn = document.getElementById('closeModal');
        
        // --- –ù–û–í–´–ô –ö–û–î –ù–ê–ß–ê–õ–û ---
        const postAdBtn = document.getElementById('postAdBtn');

        postAdBtn.addEventListener('click', (e) => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            // (–º—ã —Å–æ–∑–¥–∞–µ–º .user-profile-wrapper –≤ –ø–µ—Ä–≤–æ–º —Å–∫—Ä–∏–ø—Ç–µ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ)
            const isUserLoggedIn = document.querySelector('.user-profile-wrapper');

            if (!isUserLoggedIn) {
                e.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ
                modal.classList.add('active'); // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—Ö–æ–¥–∞
                
            }
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω, —Å–∫—Ä–∏–ø—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç, 
        });

        loginBtn.onclick = () => modal.classList.add('active');
        closeBtn.onclick = () => modal.classList.remove('active');
        window.onclick = (e) => { if (e.target === modal) modal.classList.remove('active'); }

        function switchTab(tab) {
            const loginForm = document.getElementById('loginForm');
            const regForm = document.getElementById('registerForm');
            const tabs = document.querySelectorAll('.btn-tab');
            
            if(tab === 'login') {
                loginForm.style.display = 'block';
                regForm.style.display = 'none';
                tabs[0].style.borderColor = 'var(--color-primary)';
                tabs[0].style.color = 'var(--color-text)';
                tabs[1].style.borderColor = 'transparent';
                tabs[1].style.color = 'var(--color-text-light)';
            } else {
                loginForm.style.display = 'none';
                regForm.style.display = 'block';
                tabs[1].style.borderColor = 'var(--color-primary)';
                tabs[1].style.color = 'var(--color-text)';
                tabs[0].style.borderColor = 'transparent';
                tabs[0].style.color = 'var(--color-text-light)';
            }
        }

        // Login Form Handling

        document.getElementById('emailAuthForm').addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const form = e.target;
                        const inputs = form.querySelectorAll('.form-input');
                        const [username_or_email, passInput] = inputs;
                        const errorMessages = form.querySelectorAll('.error-message');
                        
                        errorMessages.forEach(err => err.textContent = '');
                        
                        let hasError = false;
                        
                        if (hasError) return;
                        
                        const data = {
                            username_or_email: username_or_email.value,
                            password: passInput.value
                        };
                        
                        try {
                            const response = await fetch(`${AUTH_API}/login`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data),
                                credentials: 'include'
                            });
                            const result = await response.json();
                            
                            if (response.status === 406) {
                                if (result.errors) {
                                    if (result.errors.auth) {
                                        errorMessages[0].textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
                                    }
                                }
                            } else if (response.ok) {
                                console.log("Successful login");
                                window.location.href = '/';
                            }
                        } catch (err) {
                            console.error(err);
                        }
                    });
                    
                    document.getElementById('emailAuthForm').querySelectorAll('.form-input').forEach(input => {
                        input.addEventListener('input', (e) => {
                            e.target.parentElement.querySelector('.error-message').textContent = '';
                        });
                    });

        // Registration Form Handling

        document.getElementById('emailRegisterForm').addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const form = e.target;
                        const inputs = form.querySelectorAll('.form-input');
                        const [emailInput, nickInput, passInput, confirmPassInput] = inputs;
                        const termsCheck = form.querySelector('#termsCheck');
                        const errorMessages = form.querySelectorAll('.error-message');
                        
                        errorMessages.forEach(err => err.textContent = '');
                        
                        let hasError = false;
                        
                        if (passInput.value !== confirmPassInput.value) {
                            errorMessages[3].textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                            hasError = true;
                        }

                        if (passInput.value.length < 8) {
                            errorMessages[3].textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤';
                            hasError = true;
                        }
                        
                        if (!termsCheck.checked) {
                            errorMessages[4].textContent = '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏';
                            hasError = true;
                        }
                        
                        if (hasError) return;
                        
                        const data = {
                            email: emailInput.value,
                            username: nickInput.value,
                            password: passInput.value
                        };
                        
                        try {
                            const response = await fetch(`${AUTH_API}/register`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data),
                                credentials: 'include'
                            });
                            const result = await response.json();
                            
                            if (response.status === 406) {
                                if (result.errors) {
                                    if (result.errors.email) {
                                        errorMessages[0].textContent = '–¢–∞–∫–∞—è –ø–æ—á—Ç–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                                    }
                                    if (result.errors.username) {
                                        errorMessages[1].textContent = '–¢–∞–∫–æ–π –Ω–∏–∫–Ω–µ–π–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                                    }
                                }
                            } else if (response.ok) {
                                window.location.href = '/';
                            }
                        } catch (err) {
                            console.error(err);
                        }
                    });
                    
                    document.getElementById('emailRegisterForm').querySelectorAll('.form-input').forEach(input => {
                        input.addEventListener('input', (e) => {
                            e.target.parentElement.querySelector('.error-message').textContent = '';
                        });
                    });
    </script>

    <script>
        // ==========================================
        // –õ–û–ì–ò–ö–ê –ó–ê–ì–†–£–ó–ö–ò –ü–û–°–¢–û–í –ò –§–ò–õ–¨–¢–†–ê–¶–ò–ò
        // ==========================================

        const productGrid = document.getElementById('productGrid');
        const applyFiltersBtn = document.getElementById('applyFiltersBtn');
        const clearFiltersBtn = document.getElementById('clearFiltersBtn');

        // –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤
        const filterModel = document.getElementById('filterModel');
        const filterBateryMin = document.getElementById('filterBateryMin');
        const filterBateryMax = document.getElementById('filterBateryMax');
        const filterCondition = document.getElementById('filterCondition');
        const filterColor = document.getElementById('filterColor');
        const filterMemory = document.getElementById('filterMemory');
        const filterPriceMin = document.getElementById('filterPriceMin');
        const filterPriceMax = document.getElementById('filterPriceMax');

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);

            if (days > 0) {
                return `${days} –¥–Ω. –Ω–∞–∑–∞–¥`;
            } else if (hours > 0) {
                return `${hours} —á. –Ω–∞–∑–∞–¥`;
            } else if (minutes > 5) {
                return `${minutes} –º. –Ω–∞–∑–∞–¥`;
            } else {
                return '–¢–æ–ª—å–∫–æ —á—Ç–æ';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Å—Ç–æ–≤
        async function loadPosts() {
            try {
                // –°–æ–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤
                const params = new URLSearchParams();
                
                if (filterModel.value) params.append('model', filterModel.value);
                if (filterBateryMin.value) params.append('batery_min', filterBateryMin.value);
                if (filterBateryMax.value) params.append('batery_max', filterBateryMax.value);
                if (filterCondition.value) params.append('condition', filterCondition.value);
                if (filterColor.value) params.append('color', filterColor.value);
                if (filterMemory.value) params.append('memory', filterMemory.value);
                if (filterPriceMin.value) params.append('price_min', filterPriceMin.value);
                if (filterPriceMax.value) params.append('price_max', filterPriceMax.value);

                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ—Å—Ç—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (–∫–µ—à–∏—Ä—É–µ–º –Ω–∞ 2 –º–∏–Ω—É—Ç—ã)
                const url = `${POSTS_API}/iphone/list?${params}`;
                console.log('–ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã —Å URL:', url);

                const response = await cachedFetch(url, {}, 2 * 60 * 1000);
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å—Ç–æ–≤: ${response.status}`);
                }

                const posts = await response.json();
                console.log('–ü–æ–ª—É—á–µ–Ω–æ –ø–æ—Å—Ç–æ–≤:', posts.length);

                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
                function formatMemory(memoryGB) {
                    if (!memoryGB) return '';
                    if (memoryGB >= 1024) {
                        return `${memoryGB / 1024}TB`;
                    }
                    return `${memoryGB}GB`;
                }

                // –û—á–∏—â–∞–µ–º —Å–µ—Ç–∫—É
                productGrid.innerHTML = '';

                if (posts.length === 0) {
                    productGrid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--color-text-light);">–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>';
                    return;
                }

                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ—Å—Ç—ã
                posts.forEach(post => {
                    const postCard = document.createElement('a');
                    postCard.href = `/product?id=${post.id}`;
                    postCard.style.textDecoration = 'none';
                    postCard.style.color = 'inherit';

                    // –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º placeholder
                    const imageUrl = post.images_url ? post.images_url.split(',')[0].trim() : null;
                    const imageDisplay = imageUrl 
                        ? `<img src="${imageUrl}" alt="iPhone" style="width: 100%; height: 100%; object-fit: cover;">`
                        : '<span style="font-weight: 600; color: #ccc;">üì±</span>';

                    postCard.innerHTML = `
                        <div style="background: #fff; border-radius: 16px; overflow: hidden; border: 1px solid var(--color-border); transition: transform 0.2s, box-shadow 0.2s; cursor: pointer; display: flex; flex-direction: column; height: 100%;" class="post-card">
                            <div style="aspect-ratio: 4 / 3; width: 100%; background: #f5f5f7; display: flex; align-items: center; justify-content: center; overflow: hidden; flex-shrink: 0;">
                                ${imageDisplay}
                            </div>
                            <div style="padding: 16px; display: flex; flex-direction: column; gap: 6px; flex-grow: 1;">
                                <div style="font-weight: 700; font-size: 18px; color: var(--color-primary);">‚Ç¨${post.price || 'N/A'}</div>
                                <div style="font-size: 15px; color: var(--color-text); min-height: 21px; line-height: 1.4;">${post.model || 'iPhone'} ${formatMemory(post.memory)}</div>
                                <div style="font-size: 12px; color: var(--color-text-light); margin-top: auto;">
                                    ${post.condition || '–ë/–£'} ‚Ä¢ ${formatDate(post.created_at)} ‚Ä¢ üëÅ ${post.view_count}
                                </div>
                            </div>
                        </div>
                    `;

                    // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
                    postCard.addEventListener('mouseenter', () => {
                        postCard.querySelector('.post-card').style.transform = 'translateY(-4px)';
                        postCard.querySelector('.post-card').style.boxShadow = '0 8px 24px rgba(0,0,0,0.12)';
                    });
                    postCard.addEventListener('mouseleave', () => {
                        postCard.querySelector('.post-card').style.transform = 'translateY(0)';
                        postCard.querySelector('.post-card').style.boxShadow = 'none';
                    });

                    productGrid.appendChild(postCard);
                });

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ–≤:', error);
                productGrid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #f44336;">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>';
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        applyFiltersBtn.addEventListener('click', loadPosts);
        clearFiltersBtn.addEventListener('click', () => {
            filterModel.value = '';
            filterBateryMin.value = '';
            filterBateryMax.value = '';
            filterCondition.value = '';
            filterColor.value = '';
            filterMemory.value = '';
            filterPriceMin.value = '';
            filterPriceMax.value = '';
            loadPosts();
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        loadPosts();

        // ================================
        // Toggle Filters (collapse/expand)
        // ================================
        const toggleFiltersBtn = document.getElementById('toggleFiltersBtn');
        const filtersBody = document.getElementById('filtersBody');

        if (toggleFiltersBtn && filtersBody) {
            // Restore previous state
            const savedState = localStorage.getItem('filters_collapsed');
            if (savedState === 'true') {
                filtersBody.classList.add('collapsed');
                toggleFiltersBtn.setAttribute('aria-expanded', 'false');
                const up = toggleFiltersBtn.querySelector('.chevron-up');
                const down = toggleFiltersBtn.querySelector('.chevron-down');
                if (up && down) { up.style.display = 'none'; down.style.display = ''; }
                // set text node
                toggleFiltersBtn.childNodes[toggleFiltersBtn.childNodes.length-1].textContent = '–ü–æ–∫–∞–∑–∞—Ç—å';
            }

            toggleFiltersBtn.addEventListener('click', () => {
                const collapsed = filtersBody.classList.toggle('collapsed');
                const expanded = !collapsed;
                toggleFiltersBtn.setAttribute('aria-expanded', String(expanded));
                const up = toggleFiltersBtn.querySelector('.chevron-up');
                const down = toggleFiltersBtn.querySelector('.chevron-down');
                if (up && down) { up.style.display = expanded ? '' : 'none'; down.style.display = expanded ? 'none' : ''; }
                toggleFiltersBtn.childNodes[toggleFiltersBtn.childNodes.length-1].textContent = expanded ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–∫–∞–∑–∞—Ç—å';
                localStorage.setItem('filters_collapsed', String(collapsed));
            });
        }

        // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞)
        // filterModel.addEventListener('change', loadPosts);
        // filterCondition.addEventListener('change', loadPosts);
    </script>
</body>
</html>

